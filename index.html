<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Block Runner Pro</title>

<style>
body {
  background:#111;
  color:white;
  font-family:Arial;
  text-align:center;
}

canvas {
  background:#222;
  display:block;
  margin:10px auto;
  border:2px solid #0a58ca;
}

button {
  padding:10px 15px;
  margin:5px;
  font-weight:bold;
  cursor:pointer;
}

#shop {
  display:none;
  background:#333;
  padding:10px;
  margin:10px auto;
  width:300px;
}

table {
  margin:auto;
  border-collapse:collapse;
}
td,th {
  border:1px solid white;
  padding:5px 10px;
}
</style>
</head>

<body>

<h1>ğŸƒ Block Runner Pro</h1>

<div>
  Nivel: <span id="nivel">1</span> |
  Monedas: <span id="monedas">0</span> |
  Skin: <span id="skin">Normal</span>
</div>

<canvas id="game" width="400" height="200"></canvas>

<button onclick="saltar()">â¬†ï¸ Saltar</button>
<button onclick="reiniciar()">ğŸ”„ Reiniciar</button>
<button onclick="abrirTienda()">ğŸ›’ Tienda</button>

<div id="shop">
  <h3>ğŸ›’ Tienda</h3>
  <button onclick="comprarSkin('Rojo',100)">Skin Roja (100)</button><br>
  <button onclick="comprarSkin('Dorado',500)">Skin Dorada (500)</button><br><br>
  <button onclick="comprarPase()">ğŸ† Pase Legendario (5000)</button>
</div>

<h3>ğŸ† Ranking</h3>
<table id="ranking">
  <tr><th>#</th><th>Puntos</th></tr>
</table>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let jugador, bloques, juego;
let gravedad = 0.8;
let velocidad = 3;
let nivel = 1;
let monedas = 0;
let puntos = 0;
let tiempoBloque = 0;
let skinActual = "Normal";
let paseLegendario = false;

function iniciar() {
  jugador = { x:40, y:150, w:20, h:20, v:0 };
  bloques = [];
  gravedad = 0.8;
  velocidad = 3;
  nivel = 1;
  monedas = 0;
  puntos = 0;
  tiempoBloque = 0;

  document.getElementById("nivel").textContent = nivel;
  document.getElementById("monedas").textContent = monedas;
  document.getElementById("skin").textContent = skinActual;

  clearInterval(juego);
  juego = setInterval(loop, 20);
}

function loop() {
  ctx.clearRect(0,0,400,200);

  // Jugador
  jugador.v += gravedad;
  jugador.y += jugador.v;

  if (jugador.y > 150) {
    jugador.y = 150;
    jugador.v = 0;
  }

  ctx.fillStyle =
    skinActual === "Dorado" ? "gold" :
    skinActual === "Rojo" ? "red" : "white";

  ctx.fillRect(jugador.x, jugador.y, jugador.w, jugador.h);

  // Bloques
  tiempoBloque++;

  let espacio = 90 - nivel * 5;
  if (espacio < 40) espacio = 40;

  if (tiempoBloque > espacio) {
    let altura = Math.random() * 60 + 30;
    let ancho = Math.random() * 25 + 20;

    bloques.push({
      x: 400,
      y: 200 - altura,
      w: ancho,
      h: altura
    });

    tiempoBloque = 0;
  }

  bloques.forEach(b => {
    b.x -= velocidad;
    ctx.fillStyle = "cyan";
    ctx.fillRect(b.x, b.y, b.w, b.h);

    // ColisiÃ³n
    if (
      jugador.x < b.x + b.w &&
      jugador.x + jugador.w > b.x &&
      jugador.y < b.y + b.h &&
      jugador.y + jugador.h > b.y
    ) {
      perder();
    }
  });

  bloques = bloques.filter(b => b.x + b.w > 0);

  // ProgresiÃ³n
  puntos++;

  if (puntos % 200 === 0) {
    nivel++;
    monedas += 20;
    velocidad += 0.3;

    document.getElementById("nivel").textContent = nivel;
    document.getElementById("monedas").textContent = monedas;
  }
}

function saltar() {
  if (jugador.y >= 150) {
    jugador.v = -16; // impulso fuerte
  }
}

function perder() {
  clearInterval(juego);
  guardarRanking();
  alert("ğŸ’€ Perdiste | Nivel: " + nivel);
}

function reiniciar() {
  iniciar();
}

function abrirTienda() {
  document.getElementById("shop").style.display =
    document.getElementById("shop").style.display === "block"
    ? "none" : "block";
}

function comprarSkin(nombre, costo) {
  if (monedas >= costo) {
    monedas -= costo;
    skinActual = nombre;
    document.getElementById("skin").textContent = nombre;
    document.getElementById("monedas").textContent = monedas;
  } else {
    alert("âŒ No tienes monedas");
  }
}

function comprarPase() {
  if (monedas >= 5000) {
    paseLegendario = true;
    alert("ğŸ† Eres el NÃšMERO UNO DEL JUEGO");
  } else {
    alert("Necesitas 5000 monedas");
  }
}

function guardarRanking() {
  let r = JSON.parse(localStorage.getItem("ranking") || "[]");
  r.push(puntos);
  r.sort((a,b)=>b-a);
  r = r.slice(0,5);
  localStorage.setItem("ranking", JSON.stringify(r));
  mostrarRanking();
}

function mostrarRanking() {
  let r = JSON.parse(localStorage.getItem("ranking") || "[]");
  let tabla = document.getElementById("ranking");
  tabla.innerHTML = "<tr><th>#</th><th>Puntos</th></tr>";
  r.forEach((p,i)=>{
    tabla.innerHTML += `<tr><td>${i+1}</td><td>${p}</td></tr>`;
  });
}

mostrarRanking();
iniciar();
</script>

</body>
</html>
